<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Try Codex on Nodester!</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="less/bootstrap.less" rel="stylesheet/less" type="text/css">

    <!-- Le fav and touch icons -->
    <!--<link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">-->
  </head>

  <body>

    <div class="topbar">
      <div class="topbar-inner">
        <div class="container-fluid">
          <a class="brand" href="#">Try Codex</a>
          <ul class="nav">
            <li><a href="#" id="runCode">Run Code</a></li>
            <li class="dropdown" data-dropdown="dropdown">
              <a href="#" class="dropdown-toggle">Edit</a>
              <ul id="file" class="dropdown-menu">
                <li><a href="#" id="codeUndo">Undo</a></li>
                <li><a href="#" id="codeRedo">Redo</a></li>
                <li class="divider"></li>
                <li><a href="#">Delete</a></li>
                <li><a href="#">Select All</a></li>
              </ul>
            </li>
            <li class="dropdown" data-dropdown="dropdown">
              <a href="#" class="dropdown-toggle">Search</a>
              <ul id="file" class="dropdown-menu">
                <li><a href="#" id="codeSearch">Find</a></li>
                <li><a href="#">Replace</a></li>
                <li class="divider"></li>
                <li><a href="#">Goto</a></li>
              </ul>
            </li>
          </ul>
          <ul id="spexMenu" class="nav">
            <li><a href="#" id="generateSpex">Generate Spex</a></li>
          </ul>
					<ul id="configMenu" class="nav secondary-nav">
						<li class="dropdown" data-dropdown="dropdown">
							<a href="#" class="dropdown-toggle">Config</a>
							<ul class="dropdown-menu">
								<li><a href="#" data-controls-modal="codeEditorConfig" data-backdrop="static">Code Editor</a></li>
								<li><a href="#" data-controls-modal="spexEditorConfig" data-backdrop="static">Spex Editor</a></li>
							</ul>
						</li>
					</ul>
        </div>
      </div>
    </div>

		<div class="leftbar">

		</div>

    <div class="container-fluid">
      <!--<div class="sidebar">
        <div class="well">
          <h5>Your File Browser, Bishes</h5>
          <ul>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
            <li><a href="#">A File</a></li>
          </ul>
        </div>
      </div>-->
      <div class="content">
        <div id="codeEditor"></div>
        <div id="spexEditor"></div>
      </div>
    </div>

    <div class="bottombar">
      <div class="bottombar-inner">
        <div class="container-fluid">
          <form id="commandLine">
            <div class="input-prepend">
              <span class="add-on">user@trycodex: ~$</span>
              <input class="xxlarge" id="clInput" name="clInput" size="500" type="text">
            </div>
          </form>
        </div>
      </div>
    </div>

		<div id="codeEditorConfig" class="modal hide">
      <div class="modal-header">
        <a href="#" class="close">&times;</a>
        <h3>Code Editor Config</h3>
      </div>
      <div class="modal-body">
				<form class="form-stacked">
					<label for="codeEditorTheme">Theme:</label>
		      <select id="codeEditorTheme">
		        <option value="ace/theme/chrome">Chrome</option>
		        <option value="ace/theme/clouds">Clouds</option>
		        <option value="ace/theme/clouds_midnight">Clouds Midnight</option>
		        <option value="ace/theme/cobalt">Cobalt</option>
		        <option value="ace/theme/crimson_editor">Crimson Editor</option>
		        <option value="ace/theme/dawn">Dawn</option>
		        <option value="ace/theme/dreamweaver">Dreamweaver</option>
		        <option value="ace/theme/eclipse">Eclipse</option>
		        <option value="ace/theme/idle_fingers">Idle Fingers</option>
		        <option value="ace/theme/kr_theme">KR Theme</option>
		        <option value="ace/theme/merbivore">Merbivore</option>
		        <option value="ace/theme/merbivore_soft">Merbivore Soft</option>
		        <option value="ace/theme/mono_industrial">Mono Industrial</option>
		        <option value="ace/theme/monokai">Monokai</option>
		        <option value="ace/theme/pastel_on_dark">Pastel on Dark</option>
		        <option value="ace/theme/solarized_dark">Solarized Dark</option>
		        <option value="ace/theme/solarized_light">Solarized Light</option>
		        <option value="ace/theme/textmate" selected="selected">Textmate</option>
		        <option value="ace/theme/tomorrow">Tomorrow</option>
		        <option value="ace/theme/tomorrow_night">Tomorrow Night</option>
		        <option value="ace/theme/tomorrow_night_blue">Tomorrow Night Blue</option>
		        <option value="ace/theme/tomorrow_night_bright">Tomorrow Night Bright</option>
		        <option value="ace/theme/tomorrow_night_eighties">Tomorrow Night Eighties</option>
		        <option value="ace/theme/twilight">Twilight</option>
		        <option value="ace/theme/vibrant_ink">Vibrant Ink</option>
		      </select>
					<label for="codeEditorLanguage">Language:</label>
					<select id="codeEditorLanguage">
						<option value="javascript">JavaScript</option>
						<option value="coffeescript" selected="selected">CoffeeScript</option>
					</select>
				</form>
      </div>
      <div class="modal-footer">
        <a href="#" class="btn primary">Ok</a>
      </div>
    </div>

		<div id="spexEditorConfig" class="modal hide">
      <div class="modal-header">
        <a href="#" class="close">&times;</a>
        <h3>Spex Editor Config</h3>
      </div>
      <div class="modal-body">
				<form class="form-stacked">
					<label for="spexEditorTheme">Theme:</label>
		      <select id="spexEditorTheme">
		        <option value="ace/theme/chrome">Chrome</option>
		        <option value="ace/theme/clouds">Clouds</option>
		        <option value="ace/theme/clouds_midnight">Clouds Midnight</option>
		        <option value="ace/theme/cobalt">Cobalt</option>
		        <option value="ace/theme/crimson_editor">Crimson Editor</option>
		        <option value="ace/theme/dawn">Dawn</option>
		        <option value="ace/theme/dreamweaver">Dreamweaver</option>
		        <option value="ace/theme/eclipse">Eclipse</option>
		        <option value="ace/theme/idle_fingers">Idle Fingers</option>
		        <option value="ace/theme/kr_theme">KR Theme</option>
		        <option value="ace/theme/merbivore">Merbivore</option>
		        <option value="ace/theme/merbivore_soft">Merbivore Soft</option>
		        <option value="ace/theme/mono_industrial">Mono Industrial</option>
		        <option value="ace/theme/monokai">Monokai</option>
		        <option value="ace/theme/pastel_on_dark">Pastel on Dark</option>
		        <option value="ace/theme/solarized_dark">Solarized Dark</option>
		        <option value="ace/theme/solarized_light">Solarized Light</option>
		        <option value="ace/theme/textmate" selected="selected">Textmate</option>
		        <option value="ace/theme/tomorrow">Tomorrow</option>
		        <option value="ace/theme/tomorrow_night">Tomorrow Night</option>
		        <option value="ace/theme/tomorrow_night_blue">Tomorrow Night Blue</option>
		        <option value="ace/theme/tomorrow_night_bright">Tomorrow Night Bright</option>
		        <option value="ace/theme/tomorrow_night_eighties">Tomorrow Night Eighties</option>
		        <option value="ace/theme/twilight">Twilight</option>
		        <option value="ace/theme/vibrant_ink">Vibrant Ink</option>
		      </select>
					<label for="spexEditorLanguage">Language:</label>
					<select id="spexEditorLanguage">
						<option value="javascript">JavaScript</option>
						<option value="coffeescript" selected="selected">CoffeeScript</option>
					</select>
				</form>
      </div>
      <div class="modal-footer">
        <a href="#" class="btn primary">Ok</a>
      </div>
    </div>

		<script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>
		<script src="js/less-1.1.6.min.js" type="text/javascript"></script>
		<script src="js/bootstrap-dropdown.js" type="text/javascript"></script>
		<script src="js/bootstrap-modal.js" type="text/javascript"></script>
		<script src="js/ace/ace.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/ace/theme-chrome.js"></script>
		<script src="js/ace/theme-clouds.js"></script>
		<script src="js/ace/theme-clouds_midnight.js"></script>
		<script src="js/ace/theme-cobalt.js"></script>
		<script src="js/ace/theme-crimson_editor.js"></script>
		<script src="js/ace/theme-dawn.js"></script>
		<script src="js/ace/theme-dreamweaver.js"></script>
		<script src="js/ace/theme-eclipse.js"></script>
		<script src="js/ace/theme-idle_fingers.js"></script>
		<script src="js/ace/theme-kr_theme.js"></script>
		<script src="js/ace/theme-merbivore.js"></script>
		<script src="js/ace/theme-merbivore_soft.js"></script>
		<script src="js/ace/theme-mono_industrial.js"></script>
		<script src="js/ace/theme-monokai.js"></script>
		<script src="js/ace/theme-pastel_on_dark.js"></script>
		<script src="js/ace/theme-solarized_dark.js"></script>
		<script src="js/ace/theme-solarized_light.js"></script>
		<script src="js/ace/theme-tomorrow.js"></script>
		<script src="js/ace/theme-tomorrow_night.js"></script>
		<script src="js/ace/theme-tomorrow_night_blue.js"></script>
		<script src="js/ace/theme-tomorrow_night_bright.js"></script>
		<script src="js/ace/theme-tomorrow_night_eighties.js"></script>
		<script src="js/ace/theme-twilight.js"></script>
		<script src="js/ace/theme-vibrant_ink.js"></script>
    <script src="js/ace/mode-javascript.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/ace/mode-coffee.js" type="text/javascript" charset="utf-8"></script>
		<script>
			var codeEditor, spexEditor, JavaScriptMode, CoffeeScriptMode;
			$(window).load(function() {
				var insertAtEnd = function(textToInsert){
					var lineCount = this.getSession().getValue().split("\n").length;
					var endOfLastLine = lineCount + 1
					this.gotoLine(endOfLastLine);
					this.insert("\n" + textToInsert);
				}

        JavaScriptMode = require("ace/mode/javascript").Mode;
        CoffeeScriptMode = require("ace/mode/coffee").Mode;

				codeEditor = ace.edit("codeEditor");
console.log(codeEditor.getSession());
				spexEditor = ace.edit("spexEditor");

				codeEditor.insertAtEnd = insertAtEnd;
				spexEditor.insertAtEnd = insertAtEnd;

				codeEditor.getSession().setMode(new CoffeeScriptMode());
        spexEditor.getSession().setMode(new CoffeeScriptMode());

				codeEditor.getSession().setValue("# Editor for your amazingly functional & clean code");
				codeEditor.insertAtEnd("# Tested my .insertAtEnd function");

				spexEditor.getSession().setValue("# Editor for your Spexy specifications");

			});

      $(document).ready(function(){
        $('#codeEditorTheme').on('change', function(){
          var theme = $(this).attr('value');
          codeEditor.setTheme(theme);
        });
        $('#spexEditorTheme').on('change', function(){
          var theme = $(this).attr('value');
          spexEditor.setTheme(theme);
        });
				$('#codeEditorLanguage').on('change', function(){
					var language = $(this).attr('value');
					if(language == 'javascript') {
						codeEditor.getSession().setMode(new JavaScriptMode());
					} else if(language == 'coffeescript') {
						codeEditor.getSession().setMode(new CoffeeScriptMode());
					}
				});
				$('#spexEditorLanguage').on('change', function(){
					var language = $(this).attr('value');
					if(language == 'javascript') {
						spexEditor.getSession().setMode(new JavaScriptMode());
					} else if(language == 'coffeescript') {
						spexEditor.getSession().setMode(new CoffeeScriptMode());
					}
				});
        $('#generateSpex').on('click', function(){
          event.preventDefault();
					spexEditor.insertAtEnd("\n#>> Given a {} for {}\n\n#>> When a {} is {}\n\n#>> Then {}");
        });
        $('#runCode').on('click', function(){
          event.preventDefault();
          $.post("/boxy", { code: codeEditor.getSession().getValue() });
        });
        $('#commandLine').on('submit', function(){
          return false;
        });
        $('#codeUndo').on('click', function(){
					event.preventDefault();
          codeEditor.undo();
        });
        $('#codeRedo').on('click', function(){
					event.preventDefault();
          codeEditor.redo();
        });
				$('#codeSearch').on('click', function(){
					event.preventDefault();
					codeEditor.find('function');
				});
				$('#codeEditorConfig .btn').on('click', function(){
					$('#codeEditorConfig').modal('hide');
				});
				$('#spexEditorConfig .btn').on('click', function(){
					$('#spexEditorConfig').modal('hide');
				});
      });
		</script>
  </body>
</html>
